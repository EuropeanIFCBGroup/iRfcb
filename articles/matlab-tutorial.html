<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Handling MATLAB Results • iRfcb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Handling MATLAB Results">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iRfcb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/introduction.html">iRfcb Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/qc-tutorial.html">Quality Control of IFCB Data</a></li>
    <li><a class="dropdown-item" href="../articles/matlab-tutorial.html">Handling MATLAB Results</a></li>
    <li><a class="dropdown-item" href="../articles/dwca-tutorial.html">Creating a DwC-A from IFCB Data</a></li>
    <li><a class="dropdown-item" href="../articles/image-export-tutorial.html">Sharing Annotated IFCB Images</a></li>
    <li><a class="dropdown-item" href="../articles/ecotaxa-tutorial.html">Prepare IFCB Images for EcoTaxa</a></li>
    <li><a class="dropdown-item" href="../articles/whoi-plankton-data-integration.html">WHOI-Plankton Data Integration</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EuropeanIFCBGroup/iRfcb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Handling MATLAB Results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EuropeanIFCBGroup/iRfcb/blob/main/vignettes/articles/matlab-tutorial.Rmd" class="external-link"><code>vignettes/articles/matlab-tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>matlab-tutorial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to process and refine annotated and
automatically classified Imaging FlowCytobot (IFCB) data in R using the
<code>iRfcb</code> package. The workflow assumes that MATLAB-based
preprocessing has already been conducted using the <a href="https://github.com/hsosik/ifcb-analysis" class="external-link"><code>ifcb-analysis</code></a>
repository (Sosik and Olson 2007). This preprocessing includes
generating <code>.mat</code> files for annotated and classified
images.</p>
<p>With <code>iRfcb</code>, you can further analyze and manage IFCB
data, including summarizing annotations and class results, refining
annotations.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the package from CRAN using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"iRfcb"</span><span class="op">)</span></span></code></pre></div>
<p>Some functions from the <code>iRfcb</code> package used in this
tutorial require <code>Python</code> to be installed. You can download
<code>Python</code> from the official website: <a href="https://www.python.org/downloads/" class="external-link">python.org/downloads</a>.</p>
<p>The <code>iRfcb</code> package can be configured to automatically
activate an installed Python virtual environment (venv) upon loading by
setting an environment variable. For more details, please refer to the
package <a href="https://europeanifcbgroup.github.io/iRfcb/">README</a>.</p>
<p>Load the <code>iRfcb</code> library:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://europeanifcbgroup.github.io/iRfcb/">iRfcb</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-sample-data">Download Sample Data<a class="anchor" aria-label="anchor" href="#download-sample-data"></a>
</h3>
<p>To get started, download sample data from the <a href="https://doi.org/10.17044/scilifelab.25883455.v3" class="external-link">SMHI IFCB
Plankton Image Reference Library</a> (Torstensson et al. 2024) with the
following function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define data directory</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span>
<span></span>
<span><span class="co"># Download and extract test data in the data folder</span></span>
<span><span class="fu"><a href="../reference/ifcb_download_test_data.html">ifcb_download_test_data</a></span><span class="op">(</span></span>
<span>  dest_dir <span class="op">=</span> <span class="va">data_dir</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="classified-results-from-matlab">Classified Results from MATLAB<a class="anchor" aria-label="anchor" href="#classified-results-from-matlab"></a>
</h2>
<p>The <code>iRfcb</code> package facilitates the processing and
analysis of data classified using a random forest algorithm from the <a href="https://github.com/hsosik/ifcb-analysis" class="external-link"><code>ifcb-analysis</code></a>
repository. This workflow supports various tasks such as extracting
classified results, reading summary files, and calculating biovolume and
carbon content.</p>
<p>This section provides an overview of key functions available in
<code>iRfcb</code> for handling classified IFCB data. Step-by-step
examples are included to guide users through extracting results,
summarizing data, and leveraging functionalities for both automated and
manually annotated datasets.</p>
<div class="section level3">
<h3 id="extract-classified-images-from-a-sample">Extract Classified Images from a Sample<a class="anchor" aria-label="anchor" href="#extract-classified-images-from-a-sample"></a>
</h3>
<p>To begin working with classified data, you can extract all classified
images from a specific sample. This is especially useful for isolating
ROIs based on specific taxa or classification thresholds.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract all classified images from a sample</span></span>
<span><span class="fu"><a href="../reference/ifcb_extract_classified_images.html">ifcb_extract_classified_images</a></span><span class="op">(</span></span>
<span>  sample <span class="op">=</span> <span class="st">"D20230314T001205_IFCB134"</span>,</span>
<span>  classified_folder <span class="op">=</span> <span class="st">"data/classified"</span>,</span>
<span>  roi_folder <span class="op">=</span> <span class="st">"data/data"</span>,</span>
<span>  out_folder <span class="op">=</span> <span class="st">"data/classified_images"</span>,</span>
<span>  taxa <span class="op">=</span> <span class="st">"Tripos_lineatus"</span>, <span class="co"># A specific taxa or "All"</span></span>
<span>  threshold <span class="op">=</span> <span class="st">"opt"</span> <span class="co"># or specify another threshold</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Writing 1 ROIs from D20230314T001205_IFCB134.roi to data/classified_images/Tripos_lineatus</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="read-a-summary-file">Read a Summary File<a class="anchor" aria-label="anchor" href="#read-a-summary-file"></a>
</h3>
<p>Summary files generated by the MATLAB function
<code>countcells_allTBnew_user_training</code> provide aggregated
classified data. Use the following function to read and process these
files.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read a MATLAB summary file generated by `countcells_allTBnew_user_training`</span></span>
<span><span class="va">summary_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_read_summary.html">ifcb_read_summary</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/classified/2023/summary/summary_allTB_2023.mat"</span>,</span>
<span>  biovolume <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  threshold <span class="op">=</span> <span class="st">"opt"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 12</span></span></span>
<span><span class="co">##   sample   timestamp           date        year month   day time     ifcb_number</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;time&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> D202308… 2023-08-10 <span style="color: #949494;">11:30:59</span> 2023-08-10  <span style="text-decoration: underline;">2</span>023     8    10 11<span style="color: #949494;">:</span>30<span style="color: #949494;">:</span>59 IFCB134    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> D202308… 2023-08-10 <span style="color: #949494;">11:30:59</span> 2023-08-10  <span style="text-decoration: underline;">2</span>023     8    10 11<span style="color: #949494;">:</span>30<span style="color: #949494;">:</span>59 IFCB134    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> D202308… 2023-08-10 <span style="color: #949494;">11:30:59</span> 2023-08-10  <span style="text-decoration: underline;">2</span>023     8    10 11<span style="color: #949494;">:</span>30<span style="color: #949494;">:</span>59 IFCB134    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> D202308… 2023-08-10 <span style="color: #949494;">11:30:59</span> 2023-08-10  <span style="text-decoration: underline;">2</span>023     8    10 11<span style="color: #949494;">:</span>30<span style="color: #949494;">:</span>59 IFCB134    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> D202308… 2023-08-10 <span style="color: #949494;">11:30:59</span> 2023-08-10  <span style="text-decoration: underline;">2</span>023     8    10 11<span style="color: #949494;">:</span>30<span style="color: #949494;">:</span>59 IFCB134    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> D202308… 2023-08-10 <span style="color: #949494;">11:30:59</span> 2023-08-10  <span style="text-decoration: underline;">2</span>023     8    10 11<span style="color: #949494;">:</span>30<span style="color: #949494;">:</span>59 IFCB134    </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 more variables: ml_analyzed &lt;dbl&gt;, species &lt;chr&gt;, counts &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   counts_per_liter &lt;dbl&gt;</span></span></span></code></pre>
<p>Alternatively, <code>iRfcb</code> can directly aggregate data and
compute carbon content from classification files using the
<code><a href="../reference/ifcb_summarize_biovolumes.html">ifcb_summarize_biovolumes()</a></code> function demonstrated
below.</p>
</div>
<div class="section level3">
<h3 id="summarize-counts-biovolumes-and-carbon-content-from-classified-ifcb-data">Summarize Counts, Biovolumes and Carbon Content from Classified IFCB
Data<a class="anchor" aria-label="anchor" href="#summarize-counts-biovolumes-and-carbon-content-from-classified-ifcb-data"></a>
</h3>
<p>This function calculates aggregated biovolumes and carbon content
from IFCB samples based on feature and MATLAB classification result
files, without summarizing the data in MATLAB. The function can also be
adapted to process classification results from other non-MATLAB machine
learning algorithms (e.g., a CNN model) by providing custom lists of
image names and class labels through the <code>custom_images</code> and
<code>custom_classes</code> arguments.</p>
<p>Biovolumes are converted to carbon according to Menden-Deuer and
Lessard (2000) for individual ROIs, where different conversion factors
are applied to diatoms and non-diatom protist. If provided, it also
incorporates sample volume data from <code>.hdr</code> files to compute
biovolume and carbon content per liter of sample. See details in the
help pages for <code><a href="../reference/ifcb_summarize_biovolumes.html">ifcb_summarize_biovolumes()</a></code> and
<code><a href="../reference/ifcb_extract_biovolumes.html">ifcb_extract_biovolumes()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize biovolume data using IFCB data from classified data folder</span></span>
<span><span class="va">biovolume_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_summarize_biovolumes.html">ifcb_summarize_biovolumes</a></span><span class="op">(</span></span>
<span>  feature_folder <span class="op">=</span> <span class="st">"data/features/2023"</span>,</span>
<span>  mat_files <span class="op">=</span> <span class="st">"data/classified"</span>,</span>
<span>  hdr_folder <span class="op">=</span> <span class="st">"data/data/2023"</span>,</span>
<span>  micron_factor <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3.4</span>,</span>
<span>  diatom_class <span class="op">=</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span>  threshold <span class="op">=</span> <span class="st">"opt"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># Do not print progress bars</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">biovolume_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">##   sample             classifier class counts biovolume_mm3 carbon_ug ml_analyzed</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> D20230314T001205_… <span style="color: #949494;">"</span>Z:\\data… Chae…      1   0.000<span style="text-decoration: underline;">002</span>55  0.000<span style="text-decoration: underline;">117</span>         4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> D20230314T001205_… <span style="color: #949494;">"</span>Z:\\data… Cili…     11   0.000<span style="text-decoration: underline;">047</span>9   0.006<span style="text-decoration: underline;">01</span>          4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> D20230314T001205_… <span style="color: #949494;">"</span>Z:\\data… Cryp…    162   0.000<span style="text-decoration: underline;">029</span>1   0.004<span style="text-decoration: underline;">55</span>          4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> D20230314T001205_… <span style="color: #949494;">"</span>Z:\\data… Cyli…      4   0.000<span style="text-decoration: underline;">000</span>918 0.000<span style="text-decoration: underline;">053</span>6        4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> D20230314T001205_… <span style="color: #949494;">"</span>Z:\\data… Dino…      3   0.000<span style="text-decoration: underline;">016</span>2   0.002<span style="text-decoration: underline;">07</span>          4.57</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> D20230314T001205_… <span style="color: #949494;">"</span>Z:\\data… Dino…    137   0.000<span style="text-decoration: underline;">072</span>2   0.010<span style="text-decoration: underline;">6</span>           4.57</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: counts_per_liter &lt;dbl&gt;, biovolume_mm3_per_liter &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   carbon_ug_per_liter &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="summarize-counts-biovolumes-and-carbon-content-from-manually-annotated-ifcb-data">Summarize Counts, Biovolumes and Carbon Content from Manually
Annotated IFCB Data<a class="anchor" aria-label="anchor" href="#summarize-counts-biovolumes-and-carbon-content-from-manually-annotated-ifcb-data"></a>
</h3>
<p>The <code><a href="../reference/ifcb_summarize_biovolumes.html">ifcb_summarize_biovolumes()</a></code> function can also be
used to calculate aggregated biovolumes and carbon content from manually
annotated IFCB image data. See details in the help pages for
<code><a href="../reference/ifcb_summarize_biovolumes.html">ifcb_summarize_biovolumes()</a></code>,
<code><a href="../reference/ifcb_extract_biovolumes.html">ifcb_extract_biovolumes()</a></code> and
<code><a href="../reference/ifcb_count_mat_annotations.html">ifcb_count_mat_annotations()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize biovolume data using IFCB data from manual data folder</span></span>
<span><span class="va">manual_biovolume_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_summarize_biovolumes.html">ifcb_summarize_biovolumes</a></span><span class="op">(</span></span>
<span>  feature_folder <span class="op">=</span> <span class="st">"data/features"</span>,</span>
<span>  mat_files <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  class2use_file <span class="op">=</span> <span class="st">"data/config/class2use.mat"</span>,</span>
<span>  hdr_folder <span class="op">=</span> <span class="st">"data/data"</span>,</span>
<span>  micron_factor <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3.4</span>,</span>
<span>  diatom_class <span class="op">=</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># Do not print progress bars</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">manual_biovolume_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">##   sample             classifier class counts biovolume_mm3 carbon_ug ml_analyzed</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> D20220522T000439_… <span style="color: #BB0000;">NA</span>         Cili…      1    0.000<span style="text-decoration: underline;">003</span>27  0.000<span style="text-decoration: underline;">432</span>        4.86</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> D20220522T000439_… <span style="color: #BB0000;">NA</span>         Meso…      4    0.000<span style="text-decoration: underline;">027</span>4   0.003<span style="text-decoration: underline;">44</span>         4.86</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> D20220522T000439_… <span style="color: #BB0000;">NA</span>         Stro…      1    0.000<span style="text-decoration: underline;">003</span>86  0.000<span style="text-decoration: underline;">504</span>        4.86</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> D20220522T000439_… <span style="color: #BB0000;">NA</span>         uncl…      1    0.000<span style="text-decoration: underline;">002</span>88  0.000<span style="text-decoration: underline;">384</span>        4.86</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> D20220522T003051_… <span style="color: #BB0000;">NA</span>         Meso…      2    0.000<span style="text-decoration: underline;">012</span>2   0.001<span style="text-decoration: underline;">55</span>         2.98</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> D20220712T210855_… <span style="color: #BB0000;">NA</span>         Alex…      2    0.000<span style="text-decoration: underline;">047</span>6   0.005<span style="text-decoration: underline;">55</span>         4.91</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: counts_per_liter &lt;dbl&gt;, biovolume_mm3_per_liter &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   carbon_ug_per_liter &lt;dbl&gt;</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="manually-annotated-data-from-matlab">Manually Annotated Data from MATLAB<a class="anchor" aria-label="anchor" href="#manually-annotated-data-from-matlab"></a>
</h2>
<div class="section level3">
<h3 id="count-and-summarize-annotated-image-data">Count and Summarize Annotated Image Data<a class="anchor" aria-label="anchor" href="#count-and-summarize-annotated-image-data"></a>
</h3>
<div class="section level4">
<h4 id="png-directory">PNG Directory<a class="anchor" aria-label="anchor" href="#png-directory"></a>
</h4>
<p>Summarize counts of annotated images at the sample and class levels.
The <code>hdr_folder</code> can be included to add GPS positions to the
sample data frame:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarise counts on sample level</span></span>
<span><span class="va">png_per_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_summarize_png_counts.html">ifcb_summarize_png_counts</a></span><span class="op">(</span>png_folder <span class="op">=</span> <span class="st">"data/png"</span>,</span>
<span>                                            hdr_folder <span class="op">=</span> <span class="st">"data/data"</span>,</span>
<span>                                            sum_level <span class="op">=</span> <span class="st">"sample"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">png_per_sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 13</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   sample, ifcb_number [3]</span></span></span>
<span><span class="co">##   sample    ifcb_number class_name n_images roi_numbers gpsLatitude gpsLongitude</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> D2022052… IFCB134     Ciliophora        1 5                    <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> D2022052… IFCB134     Mesodiniu…        4 2, 6, 7, 8           <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> D2022052… IFCB134     Strombidi…        1 3                    <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> D2022052… IFCB134     Mesodiniu…        2 2, 3                 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> D2022071… IFCB134     Alexandri…        2 42, 164              <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> D2022071… IFCB134     Strombidi…        2 34, 79               <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: timestamp &lt;dttm&gt;, date &lt;date&gt;, year &lt;dbl&gt;, month &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   day &lt;int&gt;, time &lt;chr&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarise counts on class level</span></span>
<span><span class="va">png_per_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_summarize_png_counts.html">ifcb_summarize_png_counts</a></span><span class="op">(</span>png_folder <span class="op">=</span> <span class="st">"data/png"</span>,</span>
<span>                                           sum_level <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">png_per_class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##   class_name                  n_images</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Alexandrium_pseudogonyaulax        3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Amphidnium-like                    1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Chaetoceros_spp_chain              6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Chaetoceros_spp_single_cell        3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Ciliophora                        23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Cryptomonadales                  245</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="matlab-files">MATLAB Files<a class="anchor" aria-label="anchor" href="#matlab-files"></a>
</h4>
<p>Count the annotations in the MATLAB files, similar to
<code><a href="../reference/ifcb_summarize_png_counts.html">ifcb_summarize_png_counts()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize counts from MATLAB files</span></span>
<span><span class="va">mat_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_count_mat_annotations.html">ifcb_count_mat_annotations</a></span><span class="op">(</span></span>
<span>  manual_files <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  class2use_file <span class="op">=</span> <span class="st">"data/config/class2use.mat"</span>,</span>
<span>  skip_class <span class="op">=</span> <span class="st">"unclassified"</span>, <span class="co"># Or class ID</span></span>
<span>  sum_level <span class="op">=</span> <span class="st">"class"</span> <span class="co"># Or per "sample"</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mat_count</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##   class                           n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Alexandrium_pseudogonyaulax     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Amphidnium-like                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Chaetoceros_spp_chain           6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Chaetoceros_spp_single_cell     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Ciliophora                     23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Cryptomonadales               245</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="run-image-gallery">Run Image Gallery<a class="anchor" aria-label="anchor" href="#run-image-gallery"></a>
</h3>
<p>To visually inspect and correct annotations, run the image
gallery.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run Shiny app</span></span>
<span><span class="fu"><a href="../reference/ifcb_run_image_gallery.html">ifcb_run_image_gallery</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/image_gallery.png" alt="image_gallery"><div class="figcaption">image_gallery</div>
</div>
<p>Individual images can be selected and a list of selected images can
be downloaded as a <code>correction</code> file. This file can be used
to correct <code>.mat</code> annotations below using the
<code><a href="../reference/ifcb_correct_annotation.html">ifcb_correct_annotation()</a></code> function.</p>
</div>
<div class="section level3">
<h3 id="correct--mat-files-after-checking-images-in-the-app">Correct .mat Files After Checking Images in the App<a class="anchor" aria-label="anchor" href="#correct--mat-files-after-checking-images-in-the-app"></a>
</h3>
<p>After reviewing images in the gallery, correct the <code>.mat</code>
files using the <code>correction</code> file with selected images:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get class2use</span></span>
<span><span class="va">class_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_get_mat_names.html">ifcb_get_mat_names</a></span><span class="op">(</span><span class="st">"data/config/class2use.mat"</span><span class="op">)</span></span>
<span><span class="va">class2use</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_get_mat_variable.html">ifcb_get_mat_variable</a></span><span class="op">(</span><span class="st">"data/config/class2use.mat"</span>, variable_name <span class="op">=</span> <span class="va">class_name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the class id of unclassified</span></span>
<span><span class="va">unclassified_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"unclassified"</span>, <span class="va">class2use</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize the python session if not already set up</span></span>
<span><span class="va">env_path</span> <span class="op">&lt;-</span> <span class="st">"~/.virtualenvs/iRfcb"</span> <span class="co"># Or your preferred venv path</span></span>
<span><span class="fu"><a href="../reference/ifcb_py_install.html">ifcb_py_install</a></span><span class="op">(</span>envname <span class="op">=</span> <span class="va">env_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correct the annotation with the output from the image gallery</span></span>
<span><span class="fu"><a href="../reference/ifcb_correct_annotation.html">ifcb_correct_annotation</a></span><span class="op">(</span></span>
<span>  manual_folder <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  out_folder <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  correction <span class="op">=</span> <span class="st">"data/manual/correction/Alexandrium_pseudogonyaulax_selected_images.txt"</span>,</span>
<span>  correct_classid <span class="op">=</span> <span class="va">unclassified_id</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="replace-specific-class-annotations">Replace Specific Class Annotations<a class="anchor" aria-label="anchor" href="#replace-specific-class-annotations"></a>
</h3>
<p>Replace all instances of a specific class with
<strong>unclassified</strong> (class id 1):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get class2use</span></span>
<span><span class="va">class_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_get_mat_names.html">ifcb_get_mat_names</a></span><span class="op">(</span><span class="st">"data/config/class2use.mat"</span><span class="op">)</span></span>
<span><span class="va">class2use</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_get_mat_variable.html">ifcb_get_mat_variable</a></span><span class="op">(</span><span class="st">"data/config/class2use.mat"</span>, variable_name <span class="op">=</span> <span class="va">class_name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the class id of Alexandrium_pseudogonyaulax</span></span>
<span><span class="va">ap_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Alexandrium_pseudogonyaulax"</span>, <span class="va">class2use</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the class id of unclassified</span></span>
<span><span class="va">unclassified_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"unclassified"</span>, <span class="va">class2use</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Move all Alexandrium_pseudogonyaulax images to unclassified</span></span>
<span><span class="fu"><a href="../reference/ifcb_replace_mat_values.html">ifcb_replace_mat_values</a></span><span class="op">(</span></span>
<span>  manual_folder <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  out_folder <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  target_id <span class="op">=</span> <span class="va">ap_id</span>,</span>
<span>  new_id <span class="op">=</span> <span class="va">unclassified_id</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="verify-correction">Verify Correction<a class="anchor" aria-label="anchor" href="#verify-correction"></a>
</h3>
<p>Verify that the corrections have been applied:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize new counts after correction</span></span>
<span><span class="va">mat_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_count_mat_annotations.html">ifcb_count_mat_annotations</a></span><span class="op">(</span></span>
<span>  manual_files <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  class2use_file <span class="op">=</span> <span class="st">"data/config/class2use.mat"</span>,</span>
<span>  skip_class <span class="op">=</span> <span class="st">"unclassified"</span>, <span class="co"># Or class ID</span></span>
<span>  sum_level <span class="op">=</span> <span class="st">"class"</span> <span class="co"># Or per "sample"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mat_count</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##   class                                  n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Amphidnium-like                        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Chaetoceros_spp_chain                  6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Chaetoceros_spp_single_cell            3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Ciliophora                            23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Cryptomonadales                      245</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Cylindrotheca_Nitzschia_longissima    47</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="annotate-images-from-png-directories">Annotate Images from PNG Directories<a class="anchor" aria-label="anchor" href="#annotate-images-from-png-directories"></a>
</h3>
<p>Annotation data for IFCB images can be stored and modified in MATLAB
<code>.mat</code> files using functions such as
<code><a href="../reference/ifcb_annotate_samples.html">ifcb_annotate_samples()</a></code>, <code><a href="../reference/ifcb_annotate_batch.html">ifcb_annotate_batch()</a></code>
and <code><a href="../reference/ifcb_adjust_classes.html">ifcb_adjust_classes()</a></code> functions.</p>
<p>If your annotations are organized as PNG images in class-named
subdirectories, you can create manual <code>.mat</code> files directly
from these images using <code><a href="../reference/ifcb_annotate_samples.html">ifcb_annotate_samples()</a></code>. This
function automatically maps each PNG to its corresponding ROI in the ADC
file, assigns class IDs based on a <code>class2use.mat</code> file, and
writes a <code>.mat</code> file ready for use with the
<code>ifcb-analysis</code> MATLAB repository.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create manual MATLAB classification files from PNG images</span></span>
<span><span class="fu"><a href="../reference/ifcb_annotate_samples.html">ifcb_annotate_samples</a></span><span class="op">(</span>png_folder <span class="op">=</span> <span class="st">"data/png"</span>,</span>
<span>                      adc_folder <span class="op">=</span> <span class="st">"data/data"</span>,</span>
<span>                      output_folder <span class="op">=</span> <span class="st">"data/manual_from_pngs"</span>,</span>
<span>                      class2use_file <span class="op">=</span> <span class="st">"data/config/class2use.mat"</span><span class="op">)</span></span></code></pre></div>
<p>This workflow simplifies converting image-based annotations into
MATLAB-compatible format, making them ready for analysis or further
adjustment.</p>
</div>
<div class="section level3">
<h3 id="annotate-images-in-batch">Annotate Images in Batch<a class="anchor" aria-label="anchor" href="#annotate-images-in-batch"></a>
</h3>
<p>If a manual file already exists for the sample, the ROI class list
will be updated accordingly using <code><a href="../reference/ifcb_annotate_batch.html">ifcb_annotate_batch()</a></code>. If
no file is found, a new <code>.mat</code> file will be created, with all
unannotated ROIs marked as unclassified.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read a file with selected images, generated by the image gallery app</span></span>
<span><span class="va">correction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/manual/correction/Alexandrium_pseudogonyaulax_selected_images.txt"</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print image names to be annotated</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">correction</span><span class="op">$</span><span class="va">image_filename</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "D20220712T210855_IFCB134_00164.png" "D20220712T222710_IFCB134_00044.png"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Re-annotate the images that were moved to unclassified earlier in the tutorial</span></span>
<span><span class="fu"><a href="../reference/ifcb_annotate_batch.html">ifcb_annotate_batch</a></span><span class="op">(</span></span>
<span>  png_images <span class="op">=</span> <span class="va">correction</span><span class="op">$</span><span class="va">image_filename</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"Alexandrium_pseudogonyaulax"</span>,</span>
<span>  manual_folder <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  adc_files <span class="op">=</span> <span class="st">"data/data"</span>,</span>
<span>  class2use_file <span class="op">=</span> <span class="st">"data/config/class2use.mat"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize new counts after re-annotation</span></span>
<span><span class="va">mat_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifcb_count_mat_annotations.html">ifcb_count_mat_annotations</a></span><span class="op">(</span></span>
<span>  manual_files <span class="op">=</span> <span class="st">"data/manual"</span>,</span>
<span>  class2use_file <span class="op">=</span> <span class="st">"data/config/class2use.mat"</span>,</span>
<span>  skip_class <span class="op">=</span> <span class="st">"unclassified"</span>,</span>
<span>  sum_level <span class="op">=</span> <span class="st">"class"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print output and check if Alexandrium pseudogonyaulax is back</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mat_count</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##   class                           n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Alexandrium_pseudogonyaulax     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Amphidnium-like                 1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Chaetoceros_spp_chain           6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Chaetoceros_spp_single_cell     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Ciliophora                     23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Cryptomonadales               245</span></span></code></pre>
<p>This concludes this tutorial for the <code>iRfcb</code> package. For
more detailed information, refer to the package documentation or the
other <a href="https://europeanifcbgroup.github.io/iRfcb/articles/">tutorials</a>.
See how data pipelines can be constructed using <code>iRfcb</code> in
the following <a href="https://github.com/nodc-sweden/ifcb-data-pipeline" class="external-link">Example
Project</a>. Happy analyzing!</p>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<pre><code><span><span class="co">## To cite package 'iRfcb' in publications use:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Anders Torstensson (2026). iRfcb: Tools for Managing Imaging</span></span>
<span><span class="co">##   FlowCytobot (IFCB) Data. R package version 0.7.0.</span></span>
<span><span class="co">##   https://CRAN.R-project.org/package=iRfcb</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Manual{,</span></span>
<span><span class="co">##     title = {iRfcb: Tools for Managing Imaging FlowCytobot (IFCB) Data},</span></span>
<span><span class="co">##     author = {Anders Torstensson},</span></span>
<span><span class="co">##     year = {2026},</span></span>
<span><span class="co">##     note = {R package version 0.7.0},</span></span>
<span><span class="co">##     url = {https://CRAN.R-project.org/package=iRfcb},</span></span>
<span><span class="co">##   }</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Kraft, K., Velhonoja, O., Seppälä, J., Hällfors, H., Suikkanen, S.,
Ylöstalo, P., Anglès, S., Kielosto, S., Kuosa, H., Lehtinen, S., Oja,
J., Tamminen, T. (2022). SYKE-plankton_IFCB_2022 [Data set]. <a href="https://b2share.eudat.eu" class="external-link uri">https://b2share.eudat.eu</a>. <a href="https://doi.org/10.23728/b2share.abf913e5a6ad47e6baa273ae0ed6617a" class="external-link uri">https://doi.org/10.23728/b2share.abf913e5a6ad47e6baa273ae0ed6617a</a>
</li>
<li>Menden-Deuer Susanne, Lessard Evelyn J., (2000), Carbon to volume
relationships for dinoflagellates, diatoms, and other protist plankton,
Limnology and Oceanography, 3, doi: 10.4319/lo.2000.45.3.0569.</li>
<li>Sosik, H. M. and Olson, R. J. (2007) Automated taxonomic
classification of phytoplankton sampled with imaging-in-flow cytometry.
Limnol. Oceanogr: Methods 5, 204–216.</li>
<li>Torstensson, A., Skjevik, A-T., Mohlin, M., Karlberg, M. and
Karlson, B. (2024). SMHI IFCB Plankton Image Reference Library.
SciLifeLab. Dataset. <a href="https://doi.org/10.17044/scilifelab.25883455.v3" class="external-link uri">https://doi.org/10.17044/scilifelab.25883455.v3</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anders Torstensson, DTO-BioFlow, SBDI.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ifcb_save_classification.R
\name{ifcb_save_classification}
\alias{ifcb_save_classification}
\title{Classify an IFCB Sample and Save Results as HDF5}
\usage{
ifcb_save_classification(
  roi_file,
  output_folder,
  gradio_url = "https://irfcb-classify.hf.space",
  model_name = "SMHI NIVA ResNet50 V5",
  verbose = TRUE,
  ...
)
}
\arguments{
\item{roi_file}{A character string specifying the path to the \code{.roi} file.}

\item{output_folder}{A character string specifying the directory where the
output HDF5 file will be saved. The file is named automatically based on
the sample name (e.g. \code{D20220522T003051_IFCB134_class.h5}).}

\item{gradio_url}{A character string specifying the base URL of the Gradio
application. Default is \code{"https://irfcb-classify.hf.space"}, which is an
example Hugging Face Space with limited resources intended for testing and
demonstration. For large-scale classification, deploy your own instance of
the classification app (source code:
\url{https://github.com/anderstorstensson/ifcb-classification-app}) and
pass its URL here.}

\item{model_name}{A character string specifying the name of the CNN model
to use for classification. Default is \code{"SMHI NIVA ResNet50 V5"}. Use
\code{\link[=ifcb_classify_models]{ifcb_classify_models()}} to list all available models.}

\item{verbose}{A logical value indicating whether to print progress messages.
Default is \code{TRUE}.}

\item{...}{Additional arguments passed to \code{\link[=ifcb_extract_pngs]{ifcb_extract_pngs()}} (e.g.
\code{ROInumbers}, \code{gamma}).}
}
\value{
The path to the saved HDF5 file (invisibly).
}
\description{
Extracts PNG images from an IFCB \code{.roi} file, classifies each image via the
Gradio API \code{predict_scores} endpoint (returning all class scores), fetches
per-class thresholds, and writes the results in the IFCB Dashboard v3 HDF5
classification format.
}
\details{
The output HDF5 file contains:
\describe{
\item{\code{output_scores}}{Float64 N x C matrix of class scores (Dashboard-required).}
\item{\code{class_labels}}{ASCII string vector of class names (Dashboard-required).}
\item{\code{roi_numbers}}{Integer vector of ROI numbers (Dashboard-required).}
\item{\code{classifierName}}{String, the model name used.}
\item{\code{class_labels_auto}}{ASCII string vector (N), winning class per ROI
(argmax of scores, no threshold applied).}
\item{\code{class_labels_above_threshold}}{ASCII string vector (N), winning class
or \code{"unclassified"} if below threshold.}
\item{\code{thresholds}}{Float64 vector (C) of per-class thresholds.}
}

Requires the \pkg{hdf5r} package (listed in \code{Suggests}).
}
\examples{
\dontrun{
# Classify a sample and save as HDF5
ifcb_save_classification(
  "path/to/D20220522T003051_IFCB134.roi",
  output_folder = "output"
)
# Creates: output/D20220522T003051_IFCB134_class.h5
}

}
\seealso{
\code{\link[=ifcb_classify_image]{ifcb_classify_image()}}, \code{\link[=ifcb_classify_sample]{ifcb_classify_sample()}},
\code{\link[=ifcb_classify_models]{ifcb_classify_models()}}
}

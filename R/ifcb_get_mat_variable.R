#' Get Classes from a MAT File
#'
#' This function reads a specified variable from a .mat file generated by the ifcb-analysis repository.
#' It can be used, for example, to extract lists of classes from the file.
#'
#' @param mat_file A character string specifying the path to the .mat file containing the class information.
#' @param variable_name A character string specifying the variable name in the .mat file that contains the class information.
#'                      The default is "class2use". Other examples include "class2use.manual" from a manual file, or "class2use.auto"
#'                      for a class list used for automatic assignment. You can find available variable names using the function \code{\link{ifcb_get_mat_names}}.
#' @return A character vector of class names.
#' @examples
#' \dontrun{
#' # Get class names from a class2use file
#' classes <- ifcb_get_mat_variable("path/to/class2use.mat", "class2use")
#' print(classes)
#'
#' # Get class names from a classifier file
#' class2useTB <- ifcb_get_mat_variable("path/to/classified/sample.mat", "class2useTB")
#' print(class2useTB)
#' }
#' @import R.matlab
#' @export
#' @seealso \code{\link{ifcb_get_mat_names}} \url{https://github.com/hsosik/ifcb-analysis}
ifcb_get_mat_variable <- function(mat_file, variable_name = "class2use") {
  # Read class information from the MAT file
  class_info <- R.matlab::readMat(mat_file)

  # Check if the specified variable name exists in the MAT file
  if (!variable_name %in% names(class_info)) {
    stop("Variable name not found in MAT file")
  }

  # Extract and return the classes as a character vector
  classes <- unlist(class_info[[variable_name]])

  return(classes)
}

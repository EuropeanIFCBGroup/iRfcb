<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract Annotated Images from IFCB Data — ifcb_extract_annotated_images • iRfcb</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract Annotated Images from IFCB Data — ifcb_extract_annotated_images"><meta name="description" content="This function extracts labeled images from IFCB (Imaging FlowCytobot) data,
annotated using the MATLAB code from the ifcb-analysis repository (Sosik and Olson 2007).
It reads manually classified data, maps class indices to class names, and extracts
the corresponding Region of Interest (ROI) images, saving them to the specified directory."><meta property="og:description" content="This function extracts labeled images from IFCB (Imaging FlowCytobot) data,
annotated using the MATLAB code from the ifcb-analysis repository (Sosik and Olson 2007).
It reads manually classified data, maps class indices to class names, and extracts
the corresponding Region of Interest (ROI) images, saving them to the specified directory."><meta property="og:image" content="https://europeanifcbgroup.github.io/iRfcb/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iRfcb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/a-general-tutorial.html">iRfcb Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/qc-tutorial.html">Quality Control of IFCB Data</a></li>
    <li><a class="dropdown-item" href="../articles/matlab-tutorial.html">Handling MATLAB Results</a></li>
    <li><a class="dropdown-item" href="../articles/dwca-tutorial.html">Creating a DwC-A from IFCB Data</a></li>
    <li><a class="dropdown-item" href="../articles/image-export-tutorial.html">Sharing Annotated IFCB Images</a></li>
    <li><a class="dropdown-item" href="../articles/ecotaxa-tutorial.html">Prepare IFCB Images for EcoTaxa</a></li>
    <li><a class="dropdown-item" href="../articles/whoi-plankton-data-integration.html">WHOI-Plankton Data Integration</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EuropeanIFCBGroup/iRfcb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract Annotated Images from IFCB Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/EuropeanIFCBGroup/iRfcb/blob/main/R/ifcb_extract_annotated_images.R" class="external-link"><code>R/ifcb_extract_annotated_images.R</code></a></small>
      <div class="d-none name"><code>ifcb_extract_annotated_images.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function extracts labeled images from IFCB (Imaging FlowCytobot) data,
annotated using the MATLAB code from the <code>ifcb-analysis</code> repository (Sosik and Olson 2007).
It reads manually classified data, maps class indices to class names, and extracts
the corresponding Region of Interest (ROI) images, saving them to the specified directory.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ifcb_extract_annotated_images</span><span class="op">(</span></span>
<span>  <span class="va">manual_folder</span>,</span>
<span>  <span class="va">class2use_file</span>,</span>
<span>  <span class="va">roi_folders</span>,</span>
<span>  <span class="va">out_folder</span>,</span>
<span>  skip_class <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  manual_recursive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  roi_recursive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale_bar_um <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale_micron_factor <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3.4</span>,</span>
<span>  scale_bar_position <span class="op">=</span> <span class="st">"bottomright"</span>,</span>
<span>  scale_bar_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  old_adc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_python <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  roi_folder <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-manual-folder">manual_folder<a class="anchor" aria-label="anchor" href="#arg-manual-folder"></a></dt>
<dd><p>A character string specifying the path to the directory containing the manually classified .mat files.</p></dd>


<dt id="arg-class-use-file">class2use_file<a class="anchor" aria-label="anchor" href="#arg-class-use-file"></a></dt>
<dd><p>A character string specifying the path to the file containing class names.</p></dd>


<dt id="arg-roi-folders">roi_folders<a class="anchor" aria-label="anchor" href="#arg-roi-folders"></a></dt>
<dd><p>A character vector specifying one or more directories containing the ROI files.</p></dd>


<dt id="arg-out-folder">out_folder<a class="anchor" aria-label="anchor" href="#arg-out-folder"></a></dt>
<dd><p>A character string specifying the output directory where the extracted images will be saved.</p></dd>


<dt id="arg-skip-class">skip_class<a class="anchor" aria-label="anchor" href="#arg-skip-class"></a></dt>
<dd><p>A numeric vector of class IDs or a character vector of class names to be excluded from the count. Default is NULL.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value indicating whether to print progress messages. Default is TRUE.</p></dd>


<dt id="arg-manual-recursive">manual_recursive<a class="anchor" aria-label="anchor" href="#arg-manual-recursive"></a></dt>
<dd><p>Logical. If TRUE, the function will search for MATLAB files recursively within the <code>manual_folder</code>. Default is FALSE.</p></dd>


<dt id="arg-roi-recursive">roi_recursive<a class="anchor" aria-label="anchor" href="#arg-roi-recursive"></a></dt>
<dd><p>Logical. If TRUE, the function will search for data files recursively within the <code>roi_folder</code> (if provided). Default is TRUE.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>A logical value indicating whether to overwrite existing PNG files. Default is FALSE.</p></dd>


<dt id="arg-scale-bar-um">scale_bar_um<a class="anchor" aria-label="anchor" href="#arg-scale-bar-um"></a></dt>
<dd><p>An optional numeric value specifying the length of the scale bar in micrometers. If NULL, no scale bar is added.</p></dd>


<dt id="arg-scale-micron-factor">scale_micron_factor<a class="anchor" aria-label="anchor" href="#arg-scale-micron-factor"></a></dt>
<dd><p>A numeric value defining the conversion factor from micrometers to pixels. Defaults to 1/3.4.</p></dd>


<dt id="arg-scale-bar-position">scale_bar_position<a class="anchor" aria-label="anchor" href="#arg-scale-bar-position"></a></dt>
<dd><p>A character string specifying the position of the scale bar in the image. Options are <code>"topright"</code>, <code>"topleft"</code>, <code>"bottomright"</code>, or <code>"bottomleft"</code>. Defaults to <code>"bottomright"</code>.</p></dd>


<dt id="arg-scale-bar-color">scale_bar_color<a class="anchor" aria-label="anchor" href="#arg-scale-bar-color"></a></dt>
<dd><p>A character string specifying the scale bar color. Options are <code>"black"</code> or <code>"white"</code>. Defaults to <code>"black"</code>.</p></dd>


<dt id="arg-old-adc">old_adc<a class="anchor" aria-label="anchor" href="#arg-old-adc"></a></dt>
<dd><p>A logical value indicating whether the <code>adc</code> file is of the old format (samples from IFCB1-6, labeled "IFCBxxx_YYYY_DDD_HHMMSS"). Default is FALSE.</p></dd>


<dt id="arg-use-python">use_python<a class="anchor" aria-label="anchor" href="#arg-use-python"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, attempts to read the <code>.mat</code> file using a Python-based method. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>A numeric value for gamma correction applied to the image. Default is 1 (no correction). Values &lt;1 increase contrast in dark regions, while values &gt;1 decrease contrast.</p></dd>


<dt id="arg-roi-folder">roi_folder<a class="anchor" aria-label="anchor" href="#arg-roi-folder"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a>
Use <code>roi_folders</code> instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>None. The function saves the extracted PNG images to the specified output directory.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>use_python = TRUE</code>, the function tries to read the <code>.mat</code> file using <code><a href="ifcb_read_mat.html">ifcb_read_mat()</a></code>, which relies on <code>SciPy</code>.
This approach may be faster than the default approach using <code><a href="https://rdrr.io/pkg/R.matlab/man/readMat.html" class="external-link">R.matlab::readMat()</a></code>, especially for large <code>.mat</code> files.
To enable this functionality, ensure Python is properly configured with the required dependencies.
You can initialize the Python environment and install necessary packages using <code><a href="ifcb_py_install.html">ifcb_py_install()</a></code>.</p>
<p>If <code>use_python = FALSE</code> or if <code>SciPy</code> is not available, the function falls back to using <code><a href="https://rdrr.io/pkg/R.matlab/man/readMat.html" class="external-link">R.matlab::readMat()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sosik, H. M. and Olson, R. J. (2007), Automated taxonomic classification of phytoplankton sampled with imaging-in-flow cytometry. Limnol. Oceanogr: Methods 5, 204–216.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ifcb_extract_pngs.html">ifcb_extract_pngs</a></code> <code><a href="ifcb_extract_classified_images.html">ifcb_extract_classified_images</a></code> <a href="https://github.com/hsosik/ifcb-analysis" class="external-link">https://github.com/hsosik/ifcb-analysis</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">ifcb_extract_annotated_images</span><span class="op">(</span></span></span>
<span class="r-in"><span>  manual_folder <span class="op">=</span> <span class="st">"path/to/manual_folder"</span>,</span></span>
<span class="r-in"><span>  class2use_file <span class="op">=</span> <span class="st">"path/to/class2use_file.mat"</span>,</span></span>
<span class="r-in"><span>  roi_folders <span class="op">=</span> <span class="st">"path/to/roi_folder"</span>,</span></span>
<span class="r-in"><span>  out_folder <span class="op">=</span> <span class="st">"path/to/out_folder"</span>,</span></span>
<span class="r-in"><span>  skip_class <span class="op">=</span> <span class="fl">1</span> <span class="co"># Skip "unclassified"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anders Torstensson, DTO-BioFlow, SBDI.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

